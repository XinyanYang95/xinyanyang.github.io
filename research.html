<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.294">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Selected Projects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./research.html" rel="" target="" aria-current="page">
 <span class="menu-text">Selected Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./course.html" rel="" target="">
 <span class="menu-text">Main Courses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./interests.html" rel="" target="">
 <span class="menu-text">Personal Interests</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#research-projects" id="toc-research-projects" class="nav-link active" data-scroll-target="#research-projects">Research Projects</a></li>
  <li><a href="#toy-projects" id="toc-toy-projects" class="nav-link" data-scroll-target="#toy-projects">Toy Projects</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Selected Projects</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="research-projects" class="level2">
<h2 class="anchored" data-anchor-id="research-projects">Research Projects</h2>
<!-- Thesis -->
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Designing architected metamaterials from self-assembly of magneto-elastic building blocks [THESIS]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Designing architected metamaterials from self-assembly of magneto-elastic building blocks [THESIS]
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Year</strong>: 2022-2024</p>
<p><strong>Project description</strong>: We noticed that 2D magneto-elastic networks are typically created by embedding hard magnets into soft matrices, forming a monolithic structure. While these materials possess excellent properties, any damage incurred under extreme loading is permanent. Therefore, we proposed a novel type of ordered open networks that resemble nanoporous materials, accomplished by the self-assembly of macro-scale magneto-elastic bars. These networks exhibit on-the-fly healability, a characteristic not found in monolithic solids. Our simulations reveal that these magneto-elastic networks can rearrange and break at their magnetic nodes under extreme conditions and largely recover their original network pattern under moderate random excitations. We established design criteria for forming stable open networks. We also examined the network mechanical properties using uniaxial tensile tests.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>To unravel the emergent elasticity relation of assembled magneto-elastic network from the bar units, we conducted particle dynamics simulations and put forward an analytical framework with Cauchy-Born approximation. Discussions were focused on a simplified model with perfect triangular pattern. The conformational change of the lattice in response to applied strain was captured by a combination of the rotation of each magnet bound in the magnetic node and the radial expansion of the node. The numerical and analytical analyses provide a way to predict the 2D bulk modulus of triangular magneto-elastic networks with various design parameters, including bar length and magnetic strength.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> All simulations were performed with an in-house Python simulator developed by us.</p>
<p>Later on, we further extended the design space from bar-shaped units to elements with multiple branches and active sites, significantly broadening the achievable network topology. We migrated our modeling and simulation framework to the HOOMD-blue particle simulation toolkit for better performance. We implemented replica exchange Monte Carlo (REMC) simulations to efficiently derive networks with lower defect rates. We also explored the auxetic behavior arising in one of the rectangular networks and evaluated impact responses of these openwork materials computationally and experimentally.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p><strong>Remarks</strong>: particle dynamics simulations (HOOMD-blue, Python), advanced sampling (REMC), network analysis.</p>
<table class="table-borderless table">
<caption></caption>
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="pics/thesis/cover.png" class="quarto-discovered-preview-image img-fluid"> <br> <br>Cover picture</td>
<td style="text-align: center;"><img src="pics/thesis/1.gif" class="img-fluid"> <br>Unit cell mode 1</td>
<td style="text-align: center;"><img src="pics/thesis/2.gif" class="img-fluid"> <br>Unit cell mode 2</td>
</tr>
</tbody>
</table>
<table class="table-borderless table">
<caption></caption>
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="pics/thesis/REMC.gif" class="img-fluid"> REMC (bars)</td>
<td style="text-align: center;"><img src="pics/thesis/auxetics.gif" class="img-fluid"> Axuetic behavior (crosses)</td>
<td style="text-align: center;"><img src="pics/thesis/impact2.gif" class="img-fluid"> Impact response (cross)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- Silk -->
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Dissipative particle dynamics modeling and prediction of drawn synthetic silk fibers">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dissipative particle dynamics modeling and prediction of drawn synthetic silk fibers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Year</strong>: 2023-2024</p>
<p><strong>Project description</strong>: This project aims to demonstrate how order, elongation, and inter-protein hydrogen bonding are responsible for the modular toughness, elastic modulus, maximum stress, and maximum strain achieved through post-spin drawing of spider silk proteins. I contributed by conducting dissipative particle dynamics (DPD) simulations on coarse-grained spider silk proteins in LAMMPS and developing Python scripts for network analysis on semi-crystalline protein networks obtained from these simulations. The original coarse-grained DPD model was derived from a previous publication, with one protein bead and one water bead representing three amino acids and nine water molecules, respectively.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> We added pull forces to each chain to mimic the silk processing and investigated changes in network topology and mechanical properties. This work is covered comprehensively in a recently submitted manuscript.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p><strong>Remarks</strong>: dissipative particle dynamics (DPD, LAMMPS), network analysis, Python.</p>
<table class="table-borderless table">
<caption></caption>
<colgroup>
<col style="width: 100%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="pics/silk.gif" class="img-fluid" style="width:50.0%"> <br> DPD simulation of pulling individual chains</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- COVID -->
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Targeted molecular dynamics study of SARS-CoV-2 spike protein head protomer opening and closing transitions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Targeted molecular dynamics study of SARS-CoV-2 spike protein head protomer opening and closing transitions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Year</strong>: 2020-2021</p>
<p><strong>Project description</strong>: In this study, I conducted RMSD-based Targeted Molecular Dynamics (TMD) simulations on glycosylated S-protein head protomers to complete the opening and closing transitions in a short simulation time. PCA was performed on the conformations sampled in 50-ns MD simulations, from which the initial and target structures used in TMD runs were generated. PC1 is characterized by the RBD rotating up and down. PC2 captures the NTD-SD1/SD2-RBD pocket closing and drifting. In TMD simulations, each initial structure finally reached the target conformation with an RMSD around 0.5 Å. The path completion was also validated in the 2D PC1-PC2 space. An RBD orientation dihedral was defined to quantify the global movement of RBD in the protomer, which increased or decreased nearly monotonically in the opening and closing transitions, respectively. The intra- and inter-domain salt bridges related to the protomer conformational change were investigated. Some critical backbone dihedrals reluctant to undergo the transition and remaining in the initial state were also detected.</p>
<p><strong>Remarks</strong>: protein dynamics (NAMD), advanced sampling method (TMD), Python (MDAnalysis), data analysis.</p>
<table class="table-borderless table">
<caption></caption>
<colgroup>
<col style="width: 23%">
<col style="width: 77%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="pics/COVID/D2U.gif" class="img-fluid"></td>
<td style="text-align: center;"><img src="pics/COVID/PC1.png" class="img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- MKT -->
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Multi-stability property of magneto-Kresling truss structures">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Multi-stability property of magneto-Kresling truss structures
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Year</strong>: 2020-2021</p>
<p><strong>Project description</strong>: The Kresling truss structure, derived from Kresling origami, has been widely studied for its bi-stability and various other properties that are useful for diverse engineering applications. In this project, we created a magneto-Kresling truss (MKT) design that involves embedding nodal magnets in the purely elastic Kresling truss structure, which results in a more complex energy landscape, and consequently, greater tunability under mechanical deformation. We showed that the magnetic interaction could alter the potential energy landscape by either changing the stable configuration, adjusting the energy well depth, or both. Energy wells with different minima endow this magneto-elastic structure with an outstanding energy storage capacity. More interestingly, proper design of the magneto-Kresling truss system yields a tri-stable structure, which is not possible in the absence of magnets. We also investigated the wave propagation property of a chain of MKT units with LAMMPS Molecular Dynamics Simulator. The proposed magneto-Kresling truss design sets the stage for fabricating tunable, scalable magneto-elastic multi-stable systems that can be easily utilized for applications in energy harvesting, storage, vibration control, as well as active structures with shape-shifting capability.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<p><strong>Remarks</strong>: modeling, energy minimization, Python (SciPy, mpi4py), visualization.</p>
<table class="table-borderless table">
<caption></caption>
<colgroup>
<col style="width: 90%">
<col style="width: 10%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="pics/MKT/magnet.gif" class="img-fluid" style="width:75.0%"></td>
<td style="text-align: center;"><img src="pics/MKT/dipole.png" class="img-fluid" style="width:75.0%"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="toy-projects" class="level2">
<h2 class="anchored" data-anchor-id="toy-projects">Toy Projects</h2>
<!-- folding -->
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Reproducing folded sheets with only dihedral potentials">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reproducing folded sheets with only dihedral potentials
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Year</strong>: 2020</p>
<p><strong>Project description</strong>: This toy project was inspired by protein folding. Coarse-grained (CG) protein networks are commonly represented by C<span class="math inline">\(\alpha\)</span> atom of each residue. Some CG models go beyond this representation by incorporating dihedral angles to capture detailed local conformational changes. We want to study if pure diherals are enough to reproduce protein folding on a CG level. This project involves two tasks. The first task is to fold a triangulated 2D lattice with both bonded and non-bonded (Lennard-Jones) potentials. For the bonded terms, the bonds and angles are rigid. The dihedrals are flexible. The second task is to reproduce the folded sheet with only dihedral potentials. The proper dihedral type and coefficients should come from iterative Boltzmann inversion (IBI). Here, I realized the folding by rigid bonds and angles, as well as harmonic dihedrals and LJ potentials. Then, I exported the dihedral distributions from the equilibrated system and implemented Boltzmann inversion to calculate proper dihedral potentials necessary for the system to remain folded after all other potentials being removed. This process was performed iteratively. The sheet could largely remain the initial folded shape with only the dihedral potentials calculated from IBI. Both fourier type and tabulated dihedrals were tested.</p>
<p><strong>Remarks</strong>: molecular dynamics simulations (LAMMPS), iterative Boltzmann inversion (IBI), Python (pandas, lmfit, MDAnalysis).</p>
<table class="table-borderless table">
<caption></caption>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="pics/sheet/fold.gif" class="img-fluid"> <br> Sheet folding with rigid bonds, angle, and LJ potentials</td>
<td style="text-align: center;"><img src="pics/sheet/fourier.gif" class="img-fluid"> <br> Folded sheet with only fourier type dihedral potentials</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- FEA -->
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="FEM and data-driven analysis in investigating thermal conductivity of heterogeneous material [COURSE]">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
FEM and data-driven analysis in investigating thermal conductivity of heterogeneous material [COURSE]
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Year</strong>: 2020</p>
<p><strong>Project description</strong>: This is the course project of Advanced Finite Element Methods 2 at Northwestern. In this project, a hybrid method combining finite element analysis and data-driven analysis was proposed to investigate the thermal conductivity of a simple checkerboard heterogeneous material. Finite element analysis (FEA) was first conducted with Abaqus to study the material heat flux distribution and effective thermal conductivity under different mesh refinements and material thermal conductivity ratios. With rich data produced by FEA, we built a heat flux model which can predict element-wise heat flux under a given material thermal conductivity ratio using principal component analysis (PCA) based data compression and feed-forward neural network (FFNN) regression in machine learning. Moreover, an effective thermal conductivity model with a trained convolutional neural network (CNN) was built to directly output the effective thermal conductivity using the Abaqus heat flux contour as the input. Both models display relatively high accuracy. Although the effective thermal conductivity can be calculated analytically with given heat flux contour, the toy project aims to practise integrating both FEM and data-driven analysis in solving engineering problems.</p>
<p><strong>Remarks</strong>: FEA (Abaqus), machine learning &amp; deep learning (FFNN, CNN).</p>
<table class="table-borderless table">
<caption></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 70%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="pics/FEM/heat.gif" class="img-fluid"> <br> Abaqus heat flux contour as thermal conductivity ratio varies</td>
<td style="text-align: center;"><img src="pics/FEM/CNN.png" class="img-fluid"> <br> CNN architecture</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- ## Others -->


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Yang, X., Leng, J., Sun, C., &amp; Keten, S. (2023). Self‐assembled robust 2D networks from magneto‐elastic bars. Advanced Materials Technologies, 8(14), 2202189.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Yang, X., &amp; Keten, S. (2023). Emergent elasticity relations for networks of bars with sticky magnetic ends. Extreme Mechanics Letters, 65, 102093.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Yang, X., Leng, J., Sun, C., &amp; Keten, S. (2025). Highly ordered 2D open lattices through self-assembly of magnetic units. Under review.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Lin, S., Ryu, S., Tokareva, O., Gronau, G., Jacobsen, M. M., Huang, W., … &amp; Buehler, M. J. (2015). Predictive modelling-based design and experiments for synthesis and spinning of bioinspired silk fibres. Nature communications, 6(1), 6892.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Graham, J., Subramani, S., Yang, X., Zhang, F., and Keten, S. (2025). Charting the envelope of mechanical properties of synthetic silk fibers through predictive modeling of the drawing process. Science Advances (Accepted).<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Yang, X., &amp; Keten, S. (2021). Multi-stability property of magneto-Kresling truss structures. Journal of Applied Mechanics, 88(9), 091009.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<!-- footer.html -->
<div style="text-align: left; margin-top: 10px; color: gray; font-size: small;">
    © Copyright 2024 Xinyan Yang
  </div>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>